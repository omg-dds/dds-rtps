name: Upload Artifact
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€
on: workflow_dispatch
jobs:
  download_artifact:
    runs-on: ubuntu-latest
    steps:
      - name: Get Artifact
        uses: dawidd6/action-download-artifact@v3
        with:
          name: interoperability_report
          workflow: main.yml
      - name: Create files to upload
        run: |
            current_date=$(date '+%Y-%m-%d-%H_%M_%S')
            for file in *; do \
                mv "$file" "${file%.*}_$current_date.${file##*.}"; \
            done
            zip interoperability_report_$current_date.zip *
            mkdir report_$current_date
            mv *.zip report_$current_date/
            mv *.xlsx report_$current_date/
      - name: Upload Artifact
        uses: adityak74/google-drive-upload-git-action@main
        with:
          credentials: ${{ secrets.GCP_CREDENTIAL }}
          filename: report_*/*.zip
          folderId: ${{ secrets.DRIVE_FOLDER_ID }}
          overwrite: "true"
          mirrorDirectoryStructure: "true"
